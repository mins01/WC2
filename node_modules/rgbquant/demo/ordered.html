<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Ordered Dither</title>

	<script src="../src/rgbquant.js"></script>
</head>
<body>
	<img id="img" src="scene.png" alt="">
<!--<img id="img" src="SnOkhf1.jpg" alt="">-->
	<script>
		function roundIncr(num, incr) {
			return incr * Math.round(num/incr);
		}

		var img = document.getElementById("img"),
			can = document.createElement("canvas"),
			ctx = can.getContext("2d");

		can.width = img.naturalWidth;
		can.height = img.naturalHeight;

		ctx.drawImage(img,0,0);

		var imgd = ctx.getImageData(0,0,can.width,can.height),
		//	buf32 = new Uint32Array(imgd.data.buffer),
			pxls = imgd.data,
			len = pxls.length;

		var q = new RgbQuant({colors: 32, dithKern: "Ordered4"});
		q.sample(imgd);
	//	q.histogram = hist;
		console.time("palette");
		var pal = q.palette();
		console.timeEnd("palette");

		console.time("reduce");
		var data = q.reduce(imgd);
		console.timeEnd("reduce");

		imgd.data.set(data);
		ctx.putImageData(imgd,0,0);

		document.body.appendChild(can);
	</script>
</body>
</html>